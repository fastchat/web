<div id="wrapper">
  <section ng-controller="ChatController">
    <div id="sidebar-wrapper">
      <ul class="sidebar-nav">
	<li class="sidebar-brand">
            Groups
	</li>
	<li ng-repeat="group in groups | orderBy:lastMessage.sent">
          <a class="no-wrap" href="#/chat/{{$index}}">{{ group.groupName(); }}</a>
	</li>

      </ul>
    </div>
    <div id="page-content-wrapper">
      <div class="container-fluid">
	<h2 class="no-wrap">{{ currentGroup.groupName() }}</h2>
	<div id="chatbox" scroll-glue>
	  <div ng-repeat="message in messages.slice().reverse()">
	    <div class="chat-bubble {{ message.from == profile._id ? 'me' : 'not-me' }}">
	      <div class="{{ message.from == profile._id ? 'my-avatar' : 'person'}}">
		<img src="{{ avatars[message.from] }}" class="avatar" />
		<p>{{ currentGroup.usernameFromId(message.from) }}</p>
	      </div>
	      <div ng-if="message.hasMedia == true" class="attachment">
		<div ng-if="media[message._id] == undefined" class="spinner">
		  <div class="double-bounce1"></div>
		  <div class="double-bounce2"></div>
		</div>
		<div ng-if="media[message._id] != undefined">
		  <img src="{{ media[message._id] }}" class="user-attachment" />
		</div>
	      </div>
	      <p ng-bind-html="message.toHTML()" class="chat-text"></p>
	    </div>
	  </div>

	</div> <!-- End Chat Box -->
	<div>
	  <textarea placeholder="Send a FastChat..." id="chat-input" ng-model="messageText" ng-keypress="handleEnter($event)"></textarea>
	  <a class="btn btn-info send " ng-click="chat()">Send</a>
	</div>


      </div>
    </div>


  </section>
</div>
